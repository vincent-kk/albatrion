# YAML Generator Skill

## ì—­í• 
ë‹¹ì‹ ì€ í”„ë¡œì íŠ¸ ë¶„ì„ ê²°ê³¼ë¥¼ `.project-structure.yaml` í˜•ì‹ì˜ êµ¬ì¡°í™”ëœ ì„¤ì • íŒŒì¼ë¡œ ë³€í™˜í•˜ëŠ” ì „ë¬¸ê°€ì…ë‹ˆë‹¤.

## í•µì‹¬ ì±…ì„
1. **YAML ë¬¸ì„œ ìƒì„±**: ë¶„ì„ ë°ì´í„°ë¥¼ valid YAML 2.0 í˜•ì‹ìœ¼ë¡œ ë³€í™˜
2. **ìŠ¤í‚¤ë§ˆ ì¤€ìˆ˜**: `knowledge/yaml_schema.json`ì— ì •ì˜ëœ ìŠ¤í‚¤ë§ˆ ì¤€ìˆ˜
3. **ê°€ë…ì„± ìµœì í™”**: ì ì ˆí•œ ë“¤ì—¬ì“°ê¸°, ì£¼ì„, ì„¹ì…˜ êµ¬ë¶„
4. **í•œê¸€ ì£¼ì„ ì§€ì›**: UTF-8 ì¸ì½”ë”©ìœ¼ë¡œ í•œê¸€ ì„¤ëª… ì¶”ê°€
5. **ê²€ì¦**: ìƒì„±ëœ YAMLì´ íŒŒì‹± ê°€ëŠ¥í•˜ê³  ìŠ¤í‚¤ë§ˆë¥¼ ë§Œì¡±í•˜ëŠ”ì§€ í™•ì¸

## ì…ë ¥ í˜•ì‹
`project_detector` ìŠ¤í‚¬ë¡œë¶€í„° ë‹¤ìŒ êµ¬ì¡°ì˜ ë°ì´í„°ë¥¼ ìˆ˜ì‹ í•©ë‹ˆë‹¤:

```typescript
interface ProjectDetectionResult {
  packageManager: 'yarn' | 'npm' | 'pnpm' | 'bun';
  projectType: 'monorepo' | 'single-package';
  structure: {
    root: string;
    packagesDir?: string;
    sourceDir: string;
    testsDir: string;
  };
  techStack: {
    frontend: { framework: string; language: string; ui_library: string };
    backend: { framework: string; api_style: string };
    state_management: string[];
    testing: { unit?: string; e2e?: string; mocking?: string };
  };
  commands: {
    dev: Record<string, string>;
    test: Record<string, string>;
    lint: Record<string, string>;
    build: Record<string, string>;
    custom: Record<string, string>;
  };
  namingConventions: {
    components: string;
    files: string;
    directories: string;
  };
  development: {
    ports: { frontend: number; backend: number; storybook: number };
  };
}
```

## YAML ìƒì„± í”„ë¡œì„¸ìŠ¤

### Step 1: í…œí”Œë¦¿ ì„ íƒ
**ì°¸ì¡°:** `knowledge/yaml_templates/`ì˜ í…œí”Œë¦¿ ì‚¬ìš©
- Monorepo: `monorepo_template.yaml`
- Single Package: `single_package_template.yaml`

### Step 2: ë°ì´í„° ë§¤í•‘
```typescript
const generateYAML = (data: ProjectDetectionResult): string => {
  const template = selectTemplate(data.projectType);

  // í…œí”Œë¦¿ ë³€ìˆ˜ ì¹˜í™˜
  return template
    .replace('{project_name}', data.structure.root)
    .replace('{project_type}', data.projectType)
    .replace('{package_manager}', data.packageManager)
    // ... ê¸°íƒ€ í•„ë“œ ë§¤í•‘
};
```

### Step 3: êµ¬ì¡°í™” ë° ì£¼ì„ ì¶”ê°€
**ì£¼ì„ ê·œì¹™:**
```yaml
# Auto-generated by analyze-project-structure rule
# Generated at: 2024-11-16T10:30:00Z
# Project: albatrion

project:
  name: "albatrion"                    # í”„ë¡œì íŠ¸ëª…
  type: "monorepo"                     # í”„ë¡œì íŠ¸ íƒ€ì…: monorepo | single-package
  description: "Auto-detected project structure"
```

### Step 4: ê²€ì¦ (tools/yaml_validator.ts ì‚¬ìš©)
1. **ë¬¸ë²• ê²€ì¦**: YAML íŒŒì‹± ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
2. **ìŠ¤í‚¤ë§ˆ ê²€ì¦**: JSON Schema ì¤€ìˆ˜ í™•ì¸
3. **í•„ìˆ˜ í•„ë“œ ê²€ì¦**: ëª¨ë“  required í•„ë“œ ì¡´ì¬ í™•ì¸

```typescript
const validateYAML = (yamlContent: string): ValidationResult => {
  try {
    const parsed = yaml.parse(yamlContent);
    const schemaValid = validateSchema(parsed);

    return {
      valid: schemaValid,
      errors: schemaValid ? [] : getValidationErrors(parsed)
    };
  } catch (error) {
    return {
      valid: false,
      errors: [`YAML íŒŒì‹± ì˜¤ë¥˜: ${error.message}`]
    };
  }
};
```

## ì¶œë ¥ í˜•ì‹

### ê¸°ë³¸ êµ¬ì¡°
```yaml
# Auto-generated by analyze-project-structure rule
# Generated at: {timestamp}
# Project: {project_name}

project:
  name: "{project_name}"
  type: "{project_type}"
  description: "Auto-detected project structure"

structure:
  root: "."
  packages_dir: "{packages_dir}"        # Monorepo only
  source_dir: "{source_dir}"
  tests_dir: "{tests_dir}"
  docs_dir: "docs"
  tasks_dir: ".tasks"

package_manager:
  type: "{package_manager}"
  workspace_command: "{workspace_command}"

commands:
  dev:
    all: "{dev_all_command}"
    {package_commands}
  test:
    all: "{test_all_command}"
  lint:
    all: "{lint_all_command}"
  build:
    all: "{build_all_command}"
  typecheck:
    all: "{typecheck_all_command}"
  custom:
    {custom_commands}

tech_stack:
  frontend:
    framework: "{frontend_framework}"
    language: "{language}"
    ui_library: "{ui_library}"
  backend:
    framework: "{backend_framework}"
    language: "{language}"
    api_style: "{api_style}"
  state_management:
    {state_management_list}
  testing:
    unit: "{unit_test}"
    e2e: "{e2e_test}"
    mocking: "{mocking}"

development:
  ports:
    frontend: {frontend_port}
    backend: {backend_port}
    storybook: {storybook_port}
  env_files:
    - ".env"
    - ".env.local"
    - ".env.development"

path_conventions:
  component_path: "{component_path_pattern}"
  page_path: "{page_path_pattern}"
  api_path: "{api_path_pattern}"
  test_path: "{test_path_pattern}"

naming_conventions:
  components: "{component_naming}"
  files: "{file_naming}"
  directories: "{directory_naming}"
  variables: "camelCase"

# Detected packages (for monorepo)
examples:
  packages:
    {detected_packages}
```

## íŠ¹ìˆ˜ ì²˜ë¦¬

### Case 1: Monorepo íŒ¨í‚¤ì§€ ëª©ë¡
```yaml
examples:
  packages:
    - name: "app"
      type: "frontend"
      path: "packages/app"
      framework: "react"
    - name: "api"
      type: "backend"
      path: "packages/api"
      framework: "nestjs"
```

### Case 2: ê°ì§€ ì‹¤íŒ¨ ì‹œ ê¸°ë³¸ê°’
```yaml
# âš ï¸  Warning: Could not detect project type
# â†’ Using default: single-package
project:
  type: "single-package"  # Please verify and update if needed
```

### Case 3: ì—¬ëŸ¬ íŒ¨í‚¤ì§€ ë§¤ë‹ˆì € ê°ì§€
```yaml
# âš ï¸  Warning: Multiple package managers detected (yarn.lock, package-lock.json)
# â†’ Using yarn (highest priority)
package_manager:
  type: "yarn"
```

## íŒŒì¼ ìƒì„± ìœ„ì¹˜
```
{project_root}/.project-structure.yaml
```

## ê²€ì¦ ë° í”¼ë“œë°±

### ì„±ê³µ ì¼€ì´ìŠ¤
```
âœ… .project-structure.yaml ìƒì„± ì™„ë£Œ
ğŸ“Š ê°ì§€ëœ ì •ë³´:
  - í”„ë¡œì íŠ¸ íƒ€ì…: monorepo
  - íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €: yarn
  - í”„ë¡ íŠ¸ì—”ë“œ: react + typescript
  - ë°±ì—”ë“œ: nestjs + graphql
  - í…ŒìŠ¤íŒ…: vitest + playwright

ğŸ“ íŒŒì¼ ë‚´ìš©ì„ ê²€í† í•˜ê³  í•„ìš”ì‹œ ìˆ˜ì •í•´ì£¼ì„¸ìš”.
```

### ê²€ì¦ ì‹¤íŒ¨ ì‹œ Fallback ì „ëµ

```yaml
validation_failure_handling:
  severity_high:
    conditions:
      - missing_required_fields (project.name, project.type)
      - invalid_yaml_syntax
    action: |
      âŒ ì¹˜ëª…ì  ì˜¤ë¥˜ - YAML ìƒì„± ì¤‘ë‹¨
      â†’ project-detector ìŠ¤í‚¬ ì¬ì‹¤í–‰ í•„ìš”
      â†’ ì˜¤ë¥˜ ìƒì„¸: {error_details}

  severity_medium:
    conditions:
      - invalid_field_type
      - unknown_tech_stack
      - unrecognized_framework
    action: |
      âš ï¸  ê²½ê³  - ê¸°ë³¸ê°’ìœ¼ë¡œ ëŒ€ì²´
      1. ë¬¸ì œ í•„ë“œë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
      2. YAMLì— ê²½ê³  ì£¼ì„ ì¶”ê°€:
         # âš ï¸  WARNING: {field_name} could not be detected
         # â†’ Default value used. Please verify and update.
      3. ì‚¬ìš©ìì—ê²Œ ê²€í†  ìš”ì²­ ë©”ì‹œì§€ í‘œì‹œ
    fallback_values:
      framework: "unknown"
      language: "javascript"
      package_manager: "npm"

  severity_low:
    conditions:
      - optional_field_missing (storybook_port, env_files)
      - empty_custom_commands
    action: |
      â„¹ï¸  ì„ íƒì  í•„ë“œ ëˆ„ë½ - ê¸°ë³¸ê°’ ì‚¬ìš©
      â†’ ê²½ê³  í‘œì‹œ ì—†ìŒ
      â†’ ì‚¬ìš©ì ê°œì… ë¶ˆí•„ìš”

encoding_handling:
  charset: UTF-8
  bom_removal: true
  validation_steps:
    1. YAML íŒŒì¼ ì €ì¥ ì „ UTF-8 BOM ì œê±°
    2. í•œê¸€ ì£¼ì„ ì •ìƒ í‘œì‹œ í™•ì¸ (ë””ì½”ë”© í…ŒìŠ¤íŠ¸)
    3. íŠ¹ìˆ˜ë¬¸ì ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ í™•ì¸
  encoding_test:
    - "# í•œê¸€ ì£¼ì„ í…ŒìŠ¤íŠ¸"
    - "description: \"í”„ë¡œì íŠ¸ ì„¤ëª…\""
```

### ê²€ì¦ ì‹¤íŒ¨ ì¼€ì´ìŠ¤ ì˜ˆì‹œ
```
âŒ YAML ê²€ì¦ ì‹¤íŒ¨ (ì‹¬ê°ë„: HIGH)
ì˜¤ë¥˜ ëª©ë¡:
  1. í•„ìˆ˜ í•„ë“œ ëˆ„ë½: project.name
  2. ì˜ëª»ëœ YAML ë¬¸ë²•: line 45 (ì˜ëª»ëœ ë“¤ì—¬ì“°ê¸°)

â†’ ì¡°ì¹˜: project-detector ìŠ¤í‚¬ì„ ì¬ì‹¤í–‰í•´ì£¼ì„¸ìš”.
â†’ ëª…ë ¹ì–´: [ì ì ˆí•œ ì¬ì‹¤í–‰ ëª…ë ¹ì–´ ì œì‹œ]
```

```
âš ï¸  YAML ê²€ì¦ ê²½ê³  (ì‹¬ê°ë„: MEDIUM)
ê²½ê³  ëª©ë¡:
  1. ì¸ì‹ ë¶ˆê°€ í”„ë ˆì„ì›Œí¬: tech_stack.frontend.framework
     â†’ ê¸°ë³¸ê°’ "unknown"ìœ¼ë¡œ ëŒ€ì²´ë¨
  2. ì„ íƒì  í•„ë“œ ëˆ„ë½: development.ports.storybook
     â†’ ê¸°ë³¸ê°’ 6006 ì‚¬ìš©

âœ… .project-structure.yaml íŒŒì¼ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
ğŸ“ ìœ„ ê²½ê³  í•­ëª©ì„ ê²€í† í•˜ê³  ìˆ˜ë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•´ì£¼ì„¸ìš”.
```

## ë„êµ¬ ì‹¤í–‰ ìˆœì„œ
1. **í…œí”Œë¦¿ ë¡œë“œ** - `knowledge/yaml_templates/` ì„ íƒ
2. **ë°ì´í„° ë§¤í•‘** - ì…ë ¥ ë°ì´í„°ë¥¼ í…œí”Œë¦¿ ë³€ìˆ˜ì— ë§¤í•‘
3. **YAML ìƒì„±** - ë¬¸ìì—´ ìƒì„± ë° ì£¼ì„ ì¶”ê°€
4. **ê²€ì¦** - `tools/yaml_validator.ts` ì‹¤í–‰
5. **íŒŒì¼ ì“°ê¸°** - Write ë„êµ¬ë¡œ `.project-structure.yaml` ìƒì„±
6. **í”¼ë“œë°±** - ì‚¬ìš©ìì—ê²Œ ê²°ê³¼ ìš”ì•½ ì œê³µ

## ì œì•½ ì¡°ê±´
- YAML 2.0 ìŠ¤í™ ì¤€ìˆ˜ (https://yaml.org/spec/1.2/spec.html)
- UTF-8 ì¸ì½”ë”© í•„ìˆ˜ (í•œê¸€ ì£¼ì„ ì§€ì›)
- ë“¤ì—¬ì“°ê¸°: ê³µë°± 2ì¹¸ (íƒ­ ì‚¬ìš© ê¸ˆì§€)
- ìµœëŒ€ íŒŒì¼ í¬ê¸°: 100KB
- ìˆœí™˜ ì°¸ì¡° ë°©ì§€

## ì—ëŸ¬ ì²˜ë¦¬

### Case 1: í…œí”Œë¦¿ íŒŒì¼ ì—†ìŒ
```
âŒ Error: Template not found for project type: {type}
â†’ Fallback to generic template
```

### Case 2: ìŠ¤í‚¤ë§ˆ ê²€ì¦ ì‹¤íŒ¨
```
âš ï¸  Warning: Generated YAML does not match schema
â†’ Proceeding with generation but marked for manual review
â†’ Added comment: "# âš ï¸  Please review and validate this configuration"
```

## í†µí•© ì›Œí¬í”Œë¡œìš°

```mermaid
graph LR
  A[project_detector] -->|ProjectDetectionResult| B[yaml_generator]
  B --> C[Select Template]
  C --> D[Map Data]
  D --> E[Generate YAML]
  E --> F[Validate]
  F -->|Valid| G[Write File]
  F -->|Invalid| H[Error Handling]
  G --> I[User Feedback]
  H --> I
```

## ì¶”ê°€ ì¶œë ¥ (ì„ íƒ)

### ë§ˆí¬ë‹¤ìš´ ë³´ê³ ì„œ ìƒì„± (ì„ íƒì )
```markdown
# í”„ë¡œì íŠ¸ êµ¬ì¡° ë¶„ì„ ë³´ê³ ì„œ

**í”„ë¡œì íŠ¸ëª…**: albatrion
**íƒ€ì…**: Monorepo (Yarn Workspaces)
**ë¶„ì„ ì¼ì‹œ**: 2024-11-16 10:30:00

## ğŸ“¦ íŒ¨í‚¤ì§€ êµ¬ì¡°
- @canard/schema-form (packages/canard-schema-form)
- @winglet/common-utils (packages/winglet-common-utils)
- ... (ì´ 12ê°œ íŒ¨í‚¤ì§€)

## ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ
- Frontend: React + TypeScript
- Backend: NestJS + GraphQL
- Testing: Vitest + Playwright

## ğŸ“‹ ì£¼ìš” ëª…ë ¹ì–´
- ê°œë°œ ì„œë²„: `yarn dev`
- í…ŒìŠ¤íŠ¸: `yarn test`
- ë¦°íŠ¸: `yarn lint`
- ë¹Œë“œ: `yarn build`

## âš ï¸ ì£¼ì˜ì‚¬í•­
- ì—¬ëŸ¬ íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €ê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤ (yarn.lock, package-lock.json)
- yarnì„ ì‚¬ìš© ì¤‘ì´ë¯€ë¡œ package-lock.jsonì€ ì‚­ì œë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤
```

---

> **Best Practice:** YAML ìƒì„± í›„ ë°˜ë“œì‹œ ì‚¬ìš©ì í™•ì¸ ìš”ì²­
> **Integration:** requirement-driven-development, plan-execution ê·œì¹™ê³¼ ì—°ë™
