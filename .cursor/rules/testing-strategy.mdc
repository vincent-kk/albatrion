---
description: 
globs: *.ts,*.tsx,*.js,*.jsx
alwaysApply: false
---

# Testing Strategy

ðŸ“ testing/strategy

Enabled: âœ…
Category: Testing
Tags: vitest, storybook, unit-test, integration-test, e2e
Applies To: **/__tests__/*.test.ts(x)

â¸»

âœ… Rule

1. Test Tools
	â€¢	Use vitest for unit and integration testing.
	â€¢	Use storybook for component and visual regression testing.
	â€¢	Use Playwright or Cypress for E2E tests.

â¸»

2. Progressive Testing Approach
	1.	Unit Test
	â€¢	Pure functions, utility logic, no side effects
	2.	Component Test (Storybook-based)
	â€¢	React components, UI logic and events
	3.	Integration Test
	â€¢	Combined behavior of multiple modules (e.g., API + state + UI)
	4.	E2E Test
	â€¢	Full scenario simulation from a userâ€™s perspective

â¸»

3. Quality Goals
	â€¢	Test pass rate: 100%
	â€¢	Coverage targets:
	â€¢	Core utilities and functions: 80%+
	â€¢	UI components: 60â€“80%+
	â€¢	Global baseline: 70%, improved progressively
	â€¢	Use vitest --coverage to track

â¸»

4. Test File Structure
	â€¢	Place test code next to target source code under a `__tests__`/ subfolder

â¸»

5. Naming and Style
	â€¢	Use .test.ts or .test.tsx as file extension
	â€¢	Use descriptive test names like:
should call onClick when clicked
	â€¢	Prefer AAA structure: Arrange â†’ Act â†’ Assert

â¸»

6. Mocking & Isolation
	â€¢	Always mock:
	â€¢	External APIs (e.g., fetch, localStorage)
	â€¢	Browser-specific behavior
	â€¢	For state libraries (React Query, Zustand, etc.), use proper mocking or providers

â¸»

7. CI Integration
	â€¢	All tests must run automatically on CI (e.g., GitHub Actions)
	â€¢	Coverage data should be uploaded for PR comparison (e.g., Codecov)
	â€¢	Use standard debug logs for test failures (e.g., error stack + mock context)

â¸»

ðŸ’¡ Recommended Add-ons

1. Snapshot Testing Policy
	â€¢	Use snapshots only for intentional UI tracking
	â€¢	Avoid shallow or meaningless snapshots

2. Storybook + Testing Synergy
	â€¢	Use play() function in Storybook stories for basic interaction tests
	â€¢	Align documentation scenarios with test coverage

3. Avoid Skipping Tests
	â€¢	Ban test.skip, test.only in commits
	â€¢	Enforce this via pre-commit hooks or linter rules

4. Debug Logging Standard
	â€¢	Avoid raw console.log
	â€¢	Use custom debug() utility for structured diagnostics
	â€¢	Auto-log mock info and test context when failures occur

â¸»

ðŸ“Œ Reason

A well-defined testing strategy improves code safety, confidence, and long-term maintainability.
A progressive test pyramid allows for realistic resource planning while building confidence over time.
Unified structure and criteria increase team productivity and reduce onboarding cost.

â¸»

> Copyright Â© 2025 Vincent K. Kelvin. All rights reserved.
