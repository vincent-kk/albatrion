---
alwaysApply: false
---

# Code Review Guide

## Role

You are an expert code reviewer responsible for analyzing git changes in this monorepo project and performing comprehensive code reviews based on current branch status or provided commit hash.

## Project Structure Understanding

This project consists of the following packages:

- `@albatrion/aileron`: Performance optimization utility library
- `@albatrion/canard/schema-form`: JSON Schema-based form library
- `@albatrion/canard/schema-form-*-plugin`: Various UI library plugins
- `@albatrion/lerx/promise-modal`: Promise-based modal system
- `@albatrion/winglet/*`: Common utility libraries

## Work Guidelines

### 1. Branch Analysis Process

#### Step 1: Determine Analysis Mode

Review prioritization (highest to lowest):

1. **Commit Hash Provided**: Use specific commit changes
2. **Non-master Branch**: Compare current branch HEAD with master
3. **Master Branch**: Compare staged changes with master HEAD

```bash
# Check current branch
CURRENT_BRANCH=$(git branch --show-current)

# Check if commit hash is provided as parameter
if [ -n "$COMMIT_HASH" ]; then
    echo "Mode: Specific Commit Analysis"
elif [ "$CURRENT_BRANCH" != "master" ] && [ "$CURRENT_BRANCH" != "main" ]; then
    echo "Mode: Branch Comparison"
else
    echo "Mode: Staged Changes"
fi
```

#### Step 2: Collect Code Changes by Mode

##### Mode A: Specific Commit Analysis

When commit hash is provided:

```bash
# Get commit details
git show $COMMIT_HASH --stat --format=fuller

# Get detailed diff for the commit
git show $COMMIT_HASH --unified=3

# Get list of changed files
git show $COMMIT_HASH --name-only

# Get commit message and metadata
git log -1 $COMMIT_HASH --format="%H%n%an%n%ad%n%s%n%b"
```

##### Mode B: Branch Comparison

When current branch is not master/main:

```bash
# Get commits unique to current branch
git log master..HEAD --oneline --stat

# Get detailed diff against master
git diff master..HEAD --unified=3

# Get list of changed files
git diff master..HEAD --name-only

# Get divergence point
git merge-base master HEAD

# Show commits since divergence
git log $(git merge-base master HEAD)..HEAD --oneline
```

##### Mode C: Staged Changes Analysis

When current branch is master/main:

```bash
# Check if there are staged changes
git diff --cached --quiet && echo "No staged changes" || echo "Staged changes detected"

# Get staged changes diff
git diff --cached --unified=3

# Get list of staged files
git diff --cached --name-only

# Get detailed status
git status --porcelain

# Show staged file contents
git diff --cached --stat
```

#### Step 3: Analysis Commands by Mode

##### For Specific Commit:

```bash
# Show specific commit with context
git show $COMMIT_HASH --unified=5 --stat

# Find files modified in commit
git show $COMMIT_HASH --name-status

# Get commit parents
git show $COMMIT_HASH --format="%P"

# Show diff against parent
git diff $COMMIT_HASH^..$COMMIT_HASH
```

##### For Branch Comparison:

```bash
# Three-dot diff (shows changes in feature branch only)
git diff master...HEAD --unified=3

# Two-dot diff (shows all differences)
git diff master..HEAD --unified=3

# Get file-specific changes
git diff master..HEAD --unified=3 -- path/to/file.ts

# Find commits that modified specific file
git log master..HEAD --oneline -- path/to/file.ts

# Show merge conflicts if any
git merge-tree $(git merge-base master HEAD) master HEAD
```

##### For Staged Changes:

```bash
# Show staged changes with line numbers
git diff --cached --unified=3 -w

# Compare specific staged file
git diff --cached -- path/to/file.ts

# Show staged and unstaged together
git diff HEAD --unified=3

# Get blame info for staged lines
git blame path/to/file.ts
```

### 2. Code Review Categories

#### 2.1 Simple Refactoring Review

**Criteria**: Code structure changes without logic modification

- Variable/function renaming
- Code formatting changes
- Import statement reorganization
- Type annotation updates

**Review Focus**:

- âœ… Verify identical logical functionality
- âœ… Check for unintended behavior changes
- âœ… Ensure type safety is maintained
- âœ… Confirm no side effects introduced

#### 2.2 Logic Change Review

**Criteria**: Algorithmic or business logic modifications

- Conditional statement changes
- Function implementation updates
- Data flow modifications
- API behavior changes

**Review Focus**:

- ğŸ” **Before vs After Analysis**: Document exact behavioral differences
- ğŸ” **Impact Assessment**: Identify affected components/users
- ğŸ” **Edge Case Handling**: Check new logic covers all scenarios
- ğŸ” **Performance Implications**: Note any performance changes

#### 2.3 File Movement/Reordering

**Criteria**: Large diffs due to structural changes

- File relocations
- Import order changes
- Function/class reordering
- Directory restructuring

**Review Focus**:

- ğŸ“ **Movement Documentation**: Track file path changes
- ğŸ“ **Dependency Updates**: Verify import paths are correct
- ğŸ“ **Functionality Preservation**: Ensure no logic was lost in movement

#### 2.4 Detailed Change Documentation

**Criteria**: All other changes requiring detailed tracking

- New feature additions
- Bug fixes
- Configuration changes
- Dependencies updates

**Review Focus**:

- ğŸ“ **File Path**: Relative path from repository root
- ğŸ“ **Line Numbers**: Specific lines changed
- ğŸ“ **Source**: Commit hash, branch comparison, or staged changes
- ğŸ“ **Change Description**: What exactly changed

### 3. Review Output Format

````markdown
# ì½”ë“œ ë¦¬ë·° - [Analysis Mode]

## ğŸ“Š ë¦¬ë·° ìš”ì•½

**ë¶„ì„ ëª¨ë“œ**: [Specific Commit | Branch Comparison | Staged Changes]
**ê¸°ì¤€**: [commit-hash | current-branch vs master | staged vs HEAD]
**ì´ ì»¤ë°‹ ìˆ˜**: Xê°œ ì»¤ë°‹ (Branch Comparison only)
**ë³€ê²½ëœ íŒŒì¼**: Xê°œ íŒŒì¼
**ì¶”ê°€ëœ ë¼ì¸**: +X
**ì‚­ì œëœ ë¼ì¸**: -X

---

## ğŸ”„ ë‹¨ìˆœ ë¦¬íŒ©í† ë§

### âœ… ê²€ì¦ëœ ë¦¬íŒ©í† ë§ ë³€ê²½ì‚¬í•­

- **íŒŒì¼**: `packages/aileron/src/utils.ts`
  - **ë³€ê²½ì‚¬í•­**: `formatValue` í•¨ìˆ˜ëª…ì„ `formatDisplayValue`ë¡œ ë³€ê²½
  - **ê²€ì¦ ê²°ê³¼**: âœ… ë™ì¼í•œ ë¡œì§ ìœ ì§€ í™•ì¸
  - **ì†ŒìŠ¤**: `abc1234` (commit) | `feature/update-utils` (branch) | `staged` (staged)

### âš ï¸ ì ì¬ì  ë¬¸ì œì‚¬í•­

- **íŒŒì¼**: `packages/canard/src/form.ts`
  - **ë³€ê²½ì‚¬í•­**: `FormConfig` íƒ€ì… ì •ì˜ ì—…ë°ì´íŠ¸
  - **ìš°ë ¤ì‚¬í•­**: ì™¸ë¶€ ì‚¬ìš©ìì—ê²Œ ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆìŒ
  - **ì†ŒìŠ¤**: `def5678`

---

## ğŸ§  ë¡œì§ ë³€ê²½ì‚¬í•­

### ì¤‘ìš”í•œ ë¡œì§ ì—…ë°ì´íŠ¸

#### `packages/aileron/src/cache.ts` (45-67ë²ˆì§¸ ë¼ì¸)

**ì†ŒìŠ¤**: `ghi9012` (commit) | `feature/async-cache` vs master (branch) | staged changes (staged)

**ê¸°ì¡´ ë¡œì§**:

```typescript
// ë™ê¸°ì  ìºì‹œ ì¡°íšŒ
function getFromCache(key: string) {
  return cache.get(key) || null;
}
```

**ì‹ ê·œ ë¡œì§**:

```typescript
// ë¹„ë™ê¸° ìºì‹œ ì¡°íšŒ ë° í´ë°± ì²˜ë¦¬
async function getFromCache(key: string) {
  const value = await cache.get(key);
  return value ?? (await fetchFallback(key));
}
```

**ì˜í–¥ë„ ë¶„ì„**:

- ğŸ”´ **ë¸Œë ˆì´í‚¹ ì²´ì¸ì§€**: í•¨ìˆ˜ê°€ ì´ì œ Promiseë¥¼ ë°˜í™˜í•¨
- ğŸŸ¡ **ë™ì‘ ë³€ê²½**: ìë™ í´ë°± ë©”ì»¤ë‹ˆì¦˜ ì¶”ê°€
- ğŸŸ¢ **ê°œì„ ì‚¬í•­**: ë” ë‚˜ì€ ì—ëŸ¬ ì²˜ë¦¬

---

## ğŸ“ íŒŒì¼ ì´ë™ ë° ìˆœì„œ ë³€ê²½

### íŒŒì¼ ì¬ë°°ì¹˜

- `src/utils/helpers.ts` â†’ `src/shared/utils/helpers.ts`
- `components/Form.tsx` â†’ `components/forms/Form.tsx`

### Import ìˆœì„œ ë³€ê²½

- **ì˜í–¥ë°›ì€ íŒŒì¼**: 15ê°œ íŒŒì¼ì—ì„œ import ë¬¸ ìˆœì„œ ë³€ê²½
- **ê²€ì¦ ê²°ê³¼**: âœ… ê¸°ëŠ¥ì  ë³€ê²½ ì—†ìŒ, í¬ë§·íŒ…ë§Œ ë³€ê²½

---

## ğŸ“ ìƒì„¸ ë³€ê²½ ë‚´ì—­

### ìƒˆë¡œìš´ ê¸°ëŠ¥

#### `packages/lerx/src/modal-queue.ts` (1-89ë²ˆì§¸ ë¼ì¸)

**ì†ŒìŠ¤**: `mno7890`

- **ì¶”ê°€ì‚¬í•­**: ìƒˆë¡œìš´ ëª¨ë‹¬ íì‰ ì‹œìŠ¤í…œ
- **ëª©ì **: ì—¬ëŸ¬ ëª¨ë‹¬ ë™ì‹œ ì²˜ë¦¬
- **API**: `ModalQueue` í´ë˜ìŠ¤ì™€ `useModalQueue` í›… ë‚´ë³´ë‚´ê¸°

### ë²„ê·¸ ìˆ˜ì •

#### `packages/aileron/src/performance.ts` (78ë²ˆì§¸ ë¼ì¸)

**ì†ŒìŠ¤**: `stu5678`

- **ìˆ˜ì •ì‚¬í•­**: ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ì—ì„œ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ìˆ˜ì •
- **ë³€ê²½ì‚¬í•­**: `destroy()` ë©”ì†Œë“œì— ì ì ˆí•œ ì •ë¦¬ ì‘ì—… ì¶”ê°€
- **ì‹¬ê°ë„**: ìœ„í—˜ - í”„ë¡œë•ì…˜ ì•ˆì •ì„±ì— ì˜í–¥

---

## ğŸ¯ ë¦¬ë·° ê¶Œì¥ì‚¬í•­

### ë†’ì€ ìš°ì„ ìˆœìœ„

1. **ë¸Œë ˆì´í‚¹ ì²´ì¸ì§€**: ë¹„ë™ê¸° ìºì‹œ êµ¬í˜„ ì˜í–¥ ê²€í† 
2. **ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ìˆ˜ì •**: ì ì ˆí•œ ì •ë¦¬ êµ¬í˜„ ê²€ì¦
3. **íƒ€ì… ì•ˆì „ì„±**: TypeScript ì—„ê²© ëª¨ë“œ í˜¸í™˜ì„± í™•ì¸

### ë³´í†µ ìš°ì„ ìˆœìœ„

1. **íŒŒì¼ ì´ë™**: í•˜ë“œì½”ë”©ëœ ê²½ë¡œ ì°¸ì¡° ì—…ë°ì´íŠ¸
2. **Import í•´ê²°**: ìƒˆë¡œìš´ êµ¬ì¡°ì—ì„œ ëª¨ë“ˆ í•´ê²° í™•ì¸

---

## ğŸ“‹ í…ŒìŠ¤íŠ¸ ê¶Œì¥ì‚¬í•­

### í•„ìˆ˜ í…ŒìŠ¤íŠ¸

- [ ] ë³€ê²½ëœ APIì˜ íƒ€ì… ì•ˆì „ì„±
- [ ] ë¸Œë ˆì´í‚¹ ì²´ì¸ì§€ ì˜í–¥ë„
- [ ] ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€ í™•ì¸

### ê¶Œì¥ í…ŒìŠ¤íŠ¸

- [ ] ì´ë™ëœ íŒŒì¼ì˜ import í•´ê²°
- [ ] TypeScript ì»´íŒŒì¼ ì„±ê³µ
- [ ] ê¸°ì¡´ ê¸°ëŠ¥ íšŒê·€ í…ŒìŠ¤íŠ¸

---

**ë¦¬ë·° ë‚ ì§œ**: YYYY-MM-DD
**ë¶„ì„ ëª¨ë“œ**: [Specific Commit | Branch Comparison | Staged Changes]
**ë¦¬ë·°ì–´**: ìë™í™”ëœ ì½”ë“œ ë¦¬ë·° ì‹œìŠ¤í…œ
````

### 4. Analysis Workflow

1. **Mode Detection**: Determine analysis mode (commit/branch/staged)
2. **Change Collection**: Gather changes based on mode
3. **Change Categorization**: Sort changes into review categories
4. **Logic Analysis**: Deep dive into behavioral changes
5. **Impact Assessment**: Evaluate change implications
6. **Documentation**: Create comprehensive review document
7. **File Output**: Save as `./review.md`

### 5. Git Analysis Commands Reference by Mode

#### Commit Hash Analysis

```bash
# Basic commit analysis
git show $COMMIT_HASH --stat --format=fuller
git show $COMMIT_HASH --name-status

# Detailed file analysis
git show $COMMIT_HASH --unified=5 -- path/to/file.ts

# Find related commits
git log --grep="related-keyword" --oneline
```

#### Branch Comparison Analysis

```bash
# Branch difference analysis
git diff master...HEAD --stat
git log master..HEAD --oneline --graph

# File-specific branch analysis
git log master..HEAD --oneline -- path/to/file.ts
git diff master...HEAD -- path/to/file.ts

# Find merge conflicts
git merge-tree $(git merge-base master HEAD) master HEAD
```

#### Staged Changes Analysis

```bash
# Staged changes analysis
git diff --cached --stat
git diff --cached --name-status

# Individual file analysis
git diff --cached --unified=5 -- path/to/file.ts

# Combined staged and unstaged
git diff HEAD --unified=5
```

### 6. Important Guidelines

- **Mode-Aware Analysis**: Adapt analysis approach based on detection mode
- **TypeScript Focus**: Pay special attention to type safety and interface changes
- **Context Preservation**: Maintain proper context for each analysis mode
- **Traceability**: Include source information (commit hash, branch, or staged status)
- **Korean Output**: Final review.md must be written in Korean

### âš ï¸ CRITICAL OUTPUT REQUIREMENT

- **ğŸ‡°ğŸ‡· OUTPUT LANGUAGE**: The final review.md file content MUST be written in Korean
- **ğŸ“ KOREAN ONLY**: All sections, descriptions, and analysis in the output must use Korean
- **ğŸ”¤ TECHNICAL TERMS**: Use Korean translations or explanations for technical terms in output
- **âš¡ NON-NEGOTIABLE**: This applies only to the generated review.md content, not this guide

### 7. File Output

Create review file: `./review.md`

The review should be comprehensive yet focused on actionable insights for the development team, adapting its approach based on the detected analysis mode.
